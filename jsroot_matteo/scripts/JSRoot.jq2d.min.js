var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(g){var b=function(){};b.prototype=g;return new b};$jscomp.underscoreProtoCanBeSet=function(){var g={a:!0},b={};try{return b.__proto__=g,b.a}catch(n){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(g,b){g.__proto__=b;if(g.__proto__!==b)throw new TypeError(g+" is not extensible");return g}:null;
$jscomp.inherits=function(g,b){g.prototype=$jscomp.objectCreate(b.prototype);g.prototype.constructor=g;if($jscomp.setPrototypeOf){var n=$jscomp.setPrototypeOf;n(g,b)}else for(n in b)if("prototype"!=n)if(Object.defineProperties){var l=Object.getOwnPropertyDescriptor(b,n);l&&Object.defineProperty(g,n,l)}else g[n]=b[n];g.superClass_=b.prototype};
$jscomp.findInternal=function(g,b,n){g instanceof String&&(g=String(g));for(var l=g.length,m=0;m<l;m++){var r=g[m];if(b.call(n,r,m,g))return{i:m,v:r}}return{i:-1,v:void 0}};$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(g,b,n){g!=Array.prototype&&g!=Object.prototype&&(g[b]=n.value)};$jscomp.getGlobal=function(g){return"undefined"!=typeof window&&window===g?g:"undefined"!=typeof global&&null!=global?global:g};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(g,b,n,l){if(b){n=$jscomp.global;g=g.split(".");for(l=0;l<g.length-1;l++){var m=g[l];m in n||(n[m]={});n=n[m]}g=g[g.length-1];l=n[g];b=b(l);b!=l&&null!=b&&$jscomp.defineProperty(n,g,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(g){return g?g:function(b,g){return $jscomp.findInternal(this,b,g).v}},"es6","es3");$jscomp.arrayIteratorImpl=function(g){var b=0;return function(){return b<g.length?{done:!1,value:g[b++]}:{done:!0}}};
$jscomp.arrayIterator=function(g){return{next:$jscomp.arrayIteratorImpl(g)}};$jscomp.makeIterator=function(g){var b="undefined"!=typeof Symbol&&Symbol.iterator&&g[Symbol.iterator];return b?b.call(g):$jscomp.arrayIterator(g)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(g){function b(){this.batch_=null}function n(b){return b instanceof m?b:new m(function(a,c){a(b)})}if(g&&!$jscomp.FORCE_POLYFILL_PROMISE)return g;b.prototype.asyncExecute=function(b){if(null==this.batch_){this.batch_=[];var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})}this.batch_.push(b)};var l=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(b){l(b,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var b=
this.batch_;this.batch_=[];for(var a=0;a<b.length;++a){var c=b[a];b[a]=null;try{c()}catch(d){this.asyncThrow_(d)}}}this.batch_=null};b.prototype.asyncThrow_=function(b){this.asyncExecuteFunction(function(){throw b;})};var m=function(b){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{b(a.resolve,a.reject)}catch(c){a.reject(c)}};m.prototype.createResolveAndReject_=function(){function b(d){return function(e){c||(c=!0,d.call(a,e))}}var a=this,c=!1;
return{resolve:b(this.resolveTo_),reject:b(this.reject_)}};m.prototype.resolveTo_=function(b){if(b===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof m)this.settleSameAsPromise_(b);else{a:switch(typeof b){case "object":var a=null!=b;break a;case "function":a=!0;break a;default:a=!1}a?this.resolveToNonPromiseObj_(b):this.fulfill_(b)}};m.prototype.resolveToNonPromiseObj_=function(b){var a=void 0;try{a=b.then}catch(c){this.reject_(c);return}"function"==typeof a?
this.settleSameAsThenable_(a,b):this.fulfill_(b)};m.prototype.reject_=function(b){this.settle_(2,b)};m.prototype.fulfill_=function(b){this.settle_(1,b)};m.prototype.settle_=function(b,a){if(0!=this.state_)throw Error("Cannot settle("+b+", "+a+"): Promise already settled in state"+this.state_);this.state_=b;this.result_=a;this.executeOnSettledCallbacks_()};m.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var b=0;b<this.onSettledCallbacks_.length;++b)r.asyncExecute(this.onSettledCallbacks_[b]);
this.onSettledCallbacks_=null}};var r=new b;m.prototype.settleSameAsPromise_=function(b){var a=this.createResolveAndReject_();b.callWhenSettled_(a.resolve,a.reject)};m.prototype.settleSameAsThenable_=function(b,a){var c=this.createResolveAndReject_();try{b.call(a,c.resolve,c.reject)}catch(d){c.reject(d)}};m.prototype.then=function(b,a){function c(a,c){return"function"==typeof a?function(c){try{d(a(c))}catch(p){e(p)}}:c}var d,e,f=new m(function(a,c){d=a;e=c});this.callWhenSettled_(c(b,d),c(a,e));return f};
m.prototype.catch=function(b){return this.then(void 0,b)};m.prototype.callWhenSettled_=function(b,a){function c(){switch(d.state_){case 1:b(d.result_);break;case 2:a(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?r.asyncExecute(c):this.onSettledCallbacks_.push(c)};m.resolve=n;m.reject=function(b){return new m(function(a,c){c(b)})};m.race=function(b){return new m(function(a,c){for(var d=$jscomp.makeIterator(b),e=d.next();!e.done;e=d.next())n(e.value).callWhenSettled_(a,
c)})};m.all=function(b){var a=$jscomp.makeIterator(b),c=a.next();return c.done?n([]):new m(function(b,e){function d(a){return function(c){k[a]=c;h--;0==h&&b(k)}}var k=[],h=0;do k.push(void 0),h++,n(c.value).callWhenSettled_(d(k.length-1),e),c=a.next();while(!c.done)})};return m},"es6","es3");
JSROOT.define("d3 jquery painter hierarchy jquery-ui jqueryui-mousewheel jqueryui-touch-punch".split(" "),function(g,b,n){JSROOT.loadScript("$$$style/jquery-ui");"undefined"===typeof jQuery&&(globalThis.jQuery=b);var l=JSROOT.BrowserLayout;l.prototype.setBrowserTitle=function(a){var c=g.select("#"+this.gui_div+" .jsroot_browser");c.empty()||c.select(".jsroot_browser_title").text(a)};l.prototype.toggleBrowserKind=function(a){if(this.gui_div){if(!a){if(!this.browser_kind)return;a="float"===this.browser_kind?
"fix":"float"}var c=g.select("#"+this.gui_div+" .jsroot_browser"),d=b(c.node()).find(".jsroot_browser_area"),e=this;"float"===this.browser_kind?d.css("bottom","0px").css("top","0px").css("width","").css("height","").toggleClass("jsroot_float_browser",!1).resizable("destroy").draggable("destroy"):"fix"===this.browser_kind&&(c.select(".jsroot_v_separator").remove(),d.css("left","0px"),g.select("#"+this.gui_div+"_drawing").style("left","0px"),c.select(".jsroot_h_separator").style("left","0px"),g.select("#"+
this.gui_div+"_status").style("left","0px"),e.checkResize());this.browser_kind=a;this.browser_visible=!0;"float"===a?(d.css("bottom","40px").toggleClass("jsroot_float_browser",!0).resizable({containment:"parent",minWidth:100,resize:function(){e.setButtonsPosition()},stop:function(a,c){7>b(this).parent().innerHeight()-c.position.top-c.size.height&&b(this).css("height","").css("bottom",0)}}).draggable({containment:"parent",handle:b("#"+this.gui_div).find(".jsroot_browser_title"),snap:!0,snapMode:"inner",
snapTolerance:10,drag:function(){e.setButtonsPosition()},stop:function(){7>b(this).parent().innerHeight()-b(this).offset().top-b(this).outerHeight()&&b(this).css("height","").css("bottom",0)}}),this.adjustBrowserSize()):(d.css("left",0).css("top",0).css("bottom",0).css("height",""),a=c.append("div").classed("jsroot_separator",!0).classed("jsroot_v_separator",!0).style("position","absolute").style("top",0).style("bottom",0),b(a.node()).draggable({axis:"x",cursor:"ew-resize",containment:"parent",helper:function(){return b(this).clone().css("background-color",
"grey")},drag:function(a,c){e.setButtonsPosition();e.adjustSeparators(c.position.left,null)},stop:function(){e.checkResize()}}),this.adjustSeparators(250,null,!0,!0));this.setButtonsPosition()}};l.prototype.setButtonsPosition=function(){if(this.gui_div){var a=b("#"+this.gui_div+" .jsroot_browser"),c=a.find(".jsroot_browser_btns"),d=7,e=7;if(c.length){if(this.browser_visible){e=a.find(".jsroot_browser_area");a=a.offset();var f=e.offset();d=f.top-a.top+7;e=f.left-a.left+e.innerWidth()-27}c.css("left",
e+"px").css("top",d+"px")}}};l.prototype.adjustBrowserSize=function(a){if(this.gui_div&&"float"===this.browser_kind){var c=b("#"+this.gui_div+" .jsroot_browser");if(c.length){var d=c.find(".jsroot_browser_area"),e=c.find(".jsroot_browser_hierarchy");c=e.children(":first");a?d.parent().innerHeight()-10<d.innerHeight()&&d.css("bottom","0px").css("top","0px"):c.length&&(a=e.innerHeight(),c=c.innerHeight(),void 0!==c&&c<.7*a&&d.css("bottom",""))}}};l.prototype.toggleBrowserVisisbility=function(a){var c=
this;if(this.gui_div&&"string"!==typeof this.browser_visible){var d=g.select("#"+this.gui_div+" .jsroot_browser"),e=d.select(".jsroot_browser_area");if(!e.empty()){var f=d.select(".jsroot_v_separator"),k=g.select("#"+this.gui_div+"_drawing"),h=e.property("last_left"),q=e.property("last_vsepar"),p=e.property("last_drawing");if(this.browser_visible)e.property("last_left",e.style("left")),f.empty()||(e.property("last_vsepar",f.style("left")),e.property("last_drawing",k.style("left"))),h=(-b(e.node()).outerWidth(!0)-
10).toString()+"px",q=b(d.node()).outerWidth(!0),f.empty()&&b(e.node()).offset().left>q/2&&(h=q+10+"px"),q="-10px",p="0px";else{if(a)return;e.property("last_left",null).property("last_vsepar",null).property("last_drawing",null)}var t=!this.browser_visible,l=a?0:700;this.browser_visible="changing";e.transition().style("left",h).duration(l).on("end",function(){a||(c.browser_visible=t)&&c.setButtonsPosition()});t||d.select(".jsroot_browser_btns").transition().style("left","7px").style("top","7px").duration(l);
f.empty()||(f.transition().style("left",q).duration(l),k.transition().style("left",p).duration(l).on("end",this.checkResize.bind(this)));this.status_layout&&"fix"==this.browser_kind&&(d.select(".jsroot_h_separator").transition().style("left",p).duration(l),d.select(".jsroot_status_area").transition().style("left",p).duration(l))}}};l.prototype.toggleKind=function(a){"changing"!==this.browser_visible&&(a===this.browser_kind?this.toggleBrowserVisisbility():this.toggleBrowserKind(a))};l.prototype.deleteContent=
function(){var a=g.select("#"+this.gui_div+" .jsroot_browser");if(!a.empty()){this.createStatusLine(0,"delete");var c=a.select(".jsroot_v_separator");c.empty()||b(c.node()).draggable("destroy");this.toggleBrowserVisisbility(!0);a.selectAll("*").remove();delete this.browser_visible;delete this.browser_kind;this.checkResize()}};l.prototype.createStatusLine=function(a,c){var d=g.select("#"+this.gui_div+" .jsroot_browser");if(d.empty())return Promise.resolve("");var e=this.gui_div+"_status",f=g.select("#"+
e),k=!f.empty();"toggle"===c?c=!k:"delete"===c?(c=!1,a=0,delete this.status_layout):void 0===c&&(c=!0,this.status_layout="app");if(k){if(!0===c)return Promise.resolve(e);e=d.select(".jsroot_h_separator");b(e.node()).draggable("destroy");e.remove();f.remove();"app"!==this.status_layout&&delete this.status_layout;this.status_handler&&n.showStatus===this.status_handler&&(delete n.showStatus,delete this.status_handler);this.adjustSeparators(null,0,!0);return Promise.resolve("")}if(!1===c)return Promise.resolve("");
c=g.select("#"+this.gui_div+"_drawing").style("left");f=d.insert("div",".jsroot_browser_area").attr("id",e).classed("jsroot_status_area",!0).style("position","absolute").style("left",c).style("height","20px").style("bottom",0).style("right",0).style("margin",0).style("border",0);f=d.insert("div",".jsroot_browser_area").classed("jsroot_separator",!0).classed("jsroot_h_separator",!0).style("position","absolute").style("left",c).style("right",0).style("bottom","20px").style("height","5px");var h=this;
b(f.node()).draggable({axis:"y",cursor:"ns-resize",containment:"parent",helper:function(){return b(this).clone().css("background-color","grey")},drag:function(a,c){h.adjustSeparators(null,-c.position.top)},stop:function(){h.checkResize()}});a&&"string"!==typeof a||(a=this.last_hsepar_height||20);this.adjustSeparators(null,a,!0);if("app"==this.status_layout)return Promise.resolve(e);this.status_layout=new JSROOT.GridDisplay(e,"horizx4_1213");a=["object name","object title","mouse coordinates","object info"];
for(f=0;4>f;++f)g.select(this.status_layout.getGridFrame(f)).attr("title",a[f]).style("overflow","hidden").append("label").attr("class","jsroot_status_label");this.status_handler=this.showStatus.bind(this);n.showStatus=this.status_handler;return Promise.resolve(e)};l.prototype.adjustSeparators=function(a,c,d,e){if(this.gui_div){var f=g.select("#"+this.gui_div+" .jsroot_browser");null===c&&e&&!f.select(".jsroot_h_separator").empty()&&(c=f.select(".jsroot_h_separator").style("bottom"),c="string"==typeof c&&
c.indexOf("px")==c.length-2?c.substr(0,c.length-2):null);if(null!==c){c=parseInt(c);e=f.select(".jsroot_h_separator");var k=0;e.empty()||(0>c&&(c+=b(f.node()).outerHeight(!0)-5),5>c&&(c=5),this.last_hsepar_height=c,e.style("bottom",c+"px").style("height","5px"),g.select("#"+this.gui_div+"_status").style("height",c+"px"),k=c+5+"px");g.select("#"+this.gui_div+"_drawing").style("bottom",k)}null!==a&&(a=parseInt(a),50>a&&(a=50),f.select(".jsroot_browser_area").style("width",a-5+"px"),g.select("#"+this.gui_div+
"_drawing").style("left",a+5+"px"),f.select(".jsroot_h_separator").style("left",a+5+"px"),g.select("#"+this.gui_div+"_status").style("left",a+5+"px"),f.select(".jsroot_v_separator").style("left",a+"px").style("width","5px"));d&&this.checkResize()}};l.prototype.showStatus=function(a,c,d,e){if(this.status_layout&&(b(this.status_layout.getGridFrame(0)).children("label").text(a||""),b(this.status_layout.getGridFrame(1)).children("label").text(c||""),b(this.status_layout.getGridFrame(2)).children("label").text(e||
""),b(this.status_layout.getGridFrame(3)).children("label").text(d||""),!this.status_layout.first_check)){this.status_layout.first_check=!0;for(c=a=0;4>c;++c)a=Math.max(a,b(this.status_layout.getGridFrame(c)).children("label").outerHeight());5<a&&(a>this.last_hsepar_height||a<this.last_hsepar_height+5)&&this.adjustSeparators(null,a,!0)}};l=JSROOT.HierarchyPainter;l.prototype.isLastSibling=function(a){if(!a||!a._parent||!a._parent._childs)return!1;var c=a._parent._childs;a=c.indexOf(a);if(0>a)return!1;
for(;++a<c.length;)if(!("_hidden"in c[a]))return!1;return!0};l.prototype.addItemHtml=function(a,c,b){if(!a||"_hidden"in a)return!0;var e=a===this.h,d="_childs"in a,k=n.getDrawHandle(a._kind),h="",g="",p=!1,t=!1,l=this.itemFullName(a);null!==k&&("icon"in k&&(h=k.icon),"icon2"in k&&(g=k.icon2),0==h.length&&"function"==typeof k.icon_get&&(h=k.icon_get(a,this)),"func"in k||"execute"in k||"aslink"in k||"expand"in k&&!1!==a._more)&&(p=!0);"_icon"in a&&(h=a._icon);"_icon2"in a&&(g=a._icon2);0==h.length&&
"_online"in a&&(a._icon=h="img_globe");0==h.length&&e&&(a._icon=h="img_base");if(a._more||a._expand||a._player||a._can_draw)p=!0;var m=p;m||"string"!=typeof a._kind||0!=a._kind.indexOf("ROOT.")||(m=p=!0);0==g.length&&(g=h);0==h.length&&(h=d||a._more?"img_folder":"img_page");0==g.length&&(g=d||a._more?"img_folderopen":"img_page");"update"===b?c.selectAll("*").remove():(c=c.append("div"),b&&b>=(a._parent._show_limit||JSROOT.settings.HierarchyLimit)&&(t=!0));a._d3cont=c.node();c.attr("item",l);for(var v=
c.append("div").attr("class","h_line"),w=e?null:a._parent;w&&w!==this.h;)v.insert("div",":first-child").attr("class",this.isLastSibling(w)?"img_empty":"img_line"),w=w._parent;var r="";w=!1;e||(d&&!t?(r=a._isopen?"img_minus":"img_plus",w=!0):r="img_join");var u=this;if(0<r.length){if(t||this.isLastSibling(a))r+="bottom";r=v.append("div").attr("class",r);if(w)r.style("cursor","pointer").on("click",function(a){u.tree_click(a,this,"plusminus")})}if(this.with_icons&&!t&&(h=a._isopen?g:h,h=0==h.indexOf("img_")?
v.append("div").attr("class",h).attr("title",a._kind):v.append("img").attr("src",h).attr("alt","").attr("title",a._kind).style("vertical-align","top").style("width","18px").style("height","18px"),"_icon_click"in a||k&&"icon_click"in k))h.on("click",function(a){u.tree_click(a,this,"icon")});k=v.append("a");if(p||d||t)k.attr("class","h_item").on("click",function(a){u.tree_click(a,this)});if(t)return a._break_point=!0,k.attr("title","there are "+(a._parent._childs.length-b)+" more items").text("...more..."),
!1;if("disp_kind"in u){JSROOT.settings.DragAndDrop&&p&&this.enableDrag(k.node(),l);if(JSROOT.settings.ContextMenu&&m)k.on("contextmenu",function(a){u.tree_contextmenu(a,this)});k.on("mouseover",function(){u.tree_mouseover(!0,this)}).on("mouseleave",function(){u.tree_mouseover(!1,this)})}else if(a._direct_context&&JSROOT.settings.ContextMenu)k.on("contextmenu",function(a){u.direct_contextmenu(a,this)});b=a._name;p="";"_realname"in a&&(b=a._realname);"_title"in a&&(p=a._title);"_fullname"in a&&(p+=
"  fullname: "+a._fullname);p||(p=b);k.attr("title",p).text(b+("_value"in a?":":"")).style("background",a._background?a._background:null);"_value"in a&&(v=v.append("p"),"_vclass"in a&&v.attr("class",a._vclass),a._isopen||v.html(a._value));if(d&&(e||a._isopen))for(e=c.append("div").attr("class","h_childs"),d=0;d<a._childs.length&&(c=a._childs[d],c._parent=a,this.addItemHtml(c,e,d));++d);return!0};l.prototype.toggleOpenState=function(a,c){var b=c||this.h;if(void 0===b._childs){if(!a||this.with_icons&&
!b._more&&!b._expand&&!this.canExpandItem(b))return!1;this.expandItem(this.itemFullName(b));void 0!==b._childs&&(b._isopen=!0);return b._isopen}if(b!==this.h&&a&&!b._isopen)return b._isopen=!0;for(var e=!1,f=0;f<b._childs.length;++f)this.toggleOpenState(a,b._childs[f])&&(e=!0);if(b!==this.h&&!a&&b._isopen&&!e)return delete b._isopen,!0;c||this.refreshHtml();return!1};l.prototype.refreshHtml=function(){var a=this,c=this.selectDom();if(c.empty())return Promise.resolve(this);c.html("").style("overflow",
"hidden").style("display","flex").style("flex-direction","column");var b=this,e=[],f=null;this.forEachItem(function(a){delete a._d3cont;"_fastcmd"in a&&"Command"==a._kind&&e.push(a);"_status"in a&&!f&&(f=a)});if(!this.h||c.empty())return Promise.resolve(this);if(e.length)for(var k=c.append("div").attr("class","jsroot"),h=0;h<e.length;++h){var q=k.append("button").text("").attr("class","fast_command").attr("item",this.itemFullName(e[h])).attr("title",e[h]._title).on("click",function(){b.executeCommand(g.select(this).attr("item"),
this)});"_icon"in e[h]&&q.append("img").attr("src",e[h]._icon)}k=c.append("p").attr("class","jsroot").style("margin-bottom","3px").style("margin-top",0);k.append("a").attr("class","h_button").text("open all").attr("title","open all items in the browser").on("click",function(){return a.toggleOpenState(!0)});k.append("text").text(" | ");k.append("a").attr("class","h_button").text("close all").attr("title","close all items in the browser").on("click",function(){return a.toggleOpenState(!1)});"function"==
typeof this.removeInspector&&(k.append("text").text(" | "),k.append("a").attr("class","h_button").text("remove").attr("title","remove inspector").on("click",function(){return a.removeInspector()}));"_online"in this.h&&(k.append("text").text(" | "),k.append("a").attr("class","h_button").text("reload").attr("title","reload object list from the server").on("click",function(){return a.reload()}));"disp_kind"in this&&(k.append("text").text(" | "),k.append("a").attr("class","h_button").text("clear").attr("title",
"clear all drawn objects").on("click",function(){return a.clearHierarchy(!1)}));c=c.append("div").attr("class","jsroot").style("font-size",this.with_icons?"12px":"15px").style("overflow","auto").style("flex","1");this.background&&c.style("background-color",this.background).style("margin","2px").style("padding","2px");this.addItemHtml(this.h,c.append("div").attr("class","h_tree"));this.setTopPainter();if(f&&!this.status_disabled&&!JSROOT.decodeUrl().has("nostatus")){var p=JSROOT.findFunction(f._status);
if("function"==typeof p)return this.createStatusLine().then(function(c){c&&p(c,a.itemFullName(f))})}return Promise.resolve(this)};l.prototype.updateTreeNode=function(a,c){if(void 0===c||c.empty()){c=g.select(a._d3cont?a._d3cont:null);var b=this.itemFullName(a);c.empty()&&(c=this.selectDom().select("[item='"+b+"']"));c.empty()&&"_cycle"in a&&(c=this.selectDom().select("[item='"+b+";"+a._cycle+"']"));if(c.empty())return}this.addItemHtml(a,c,"update");this.brlayout&&this.brlayout.adjustBrowserSize(!0)};
l.prototype.updateBackground=function(a,c){if(a&&a._d3cont){var b=g.select(a._d3cont);b.empty()||(b=b.select(".h_item"),b.style("background",a._background?a._background:null),c&&a._background&&b.node().scrollIntoView(!1))}};l.prototype.tree_click=function(a,c,b){if(c){var e=g.select(c.parentNode.parentNode),f=e.attr("item"),d=f?this.findItem(f):null;if(d)if(d._break_point){delete d._break_point;this.addItemHtml(d,e,"update");f=d._parent;d=f._childs.indexOf(d);e=g.select(e.node().parentNode);if(0>
d)return console.error("internal error");f._show_limit=2*(f._show_limit||JSROOT.settings.HierarchyLimit);for(d+=1;d<f._childs.length;++d){var h=f._childs[d];h._parent=f;if(!this.addItemHtml(h,e,d))break}}else{h=d;for(var q=void 0;h&&void 0===(q=h._click_action);)h=h._parent;b&&""!=b||(b="item");var p=n.getDrawSettings(d._kind);h=p.handle;if("icon"==b)f=null,"function"==typeof d._icon_click?f=d._icon_click:h&&"function"==typeof h.icon_click&&(f=h.icon_click),f&&f(d,this)&&this.updateTreeNode(d,e);
else{"item"==b&&"_expand"in d&&!a.ctrlKey&&!a.shiftKey&&(b="plusminus");if("plusminus"==b&&!("_childs"in d)&&d._more||"item"==b&&"expand"===q)return this.expandItem(f,e);if("item"==b){if("_player"in d)return this.player(f);if(h&&h.aslink)return window.open(f+"/");if(h&&h.execute)return this.executeCommand(f,c.parentNode);if(h&&h.ignore_online&&this.isOnlineItem(d))return;c=d._can_draw;b=d._more;q="expand"===this.default_by_click;var t="";a.shiftKey&&(t=h&&h.shift?h.shift:"inspect","inspect"===t&&
h&&h.noinspect&&(t=""));h&&h.ctrl&&a.ctrlKey&&(t=h.ctrl);if(!t)for(a=d._parent;a;a=a._parent)if(a._painter){c=!1;void 0===b&&(b=!1);break}d._childs&&(b=!1);void 0===c&&(c=p.draw);void 0===b&&(b=p.expand);c&&b&&!t&&(q||h&&"expand"===h.dflt?c=!1:this.isItemDisplayed(f)&&(c=!1));if(c)return this.display(f,t);if(b||q)return this.expandItem(f,e);if("string"===typeof d._kind&&0===d._kind.indexOf("ROOT.")&&p.inspect&&!1!==c)return this.display(f,"inspect");if(!d._childs||d===this.h)return}d._isopen?delete d._isopen:
d._isopen=!0;this.updateTreeNode(d,e)}}}};l.prototype.tree_mouseover=function(a,b){b=g.select(b.parentNode.parentNode).attr("item");var c=this.findItem(b);if(c){for(var e,f=c;f&&!e;)e=f._painter,f=f._parent;e&&"function"===typeof e.mouseOverHierarchy&&e.mouseOverHierarchy(a,b,c)}};l.prototype.direct_contextmenu=function(a,b){var c=this;a.preventDefault();var e=g.select(b.parentNode.parentNode).attr("item"),f=this.findItem(e);f&&"function"==typeof this.fill_context&&n.createMenu(a,this).then(function(a){c.fill_context(a,
f);0<a.size()&&(a.tree_node=b.parentNode,a.show())})};l.prototype.tree_contextmenu=function(a,b){function c(a){var b=document.createElement("div");b.innerHTML='<a href="'+a.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")+'">x</a>';return b.firstChild.href}var e=this;a.preventDefault();var f=g.select(b.parentNode.parentNode).attr("item"),k=this.findItem(f);if(k){var h=this.getOnlineProp(f),q=this.getFileProp(f);n.createMenu(a,this).then(function(a){if(""!=f||"_jsonfile"in
k)if(h)e.fillOnlineMenu(a,h,f);else{var d=n.getDrawSettings(k._kind,"nosame");k._can_draw&&(d.opts||(d.opts=[""]),0>d.opts.indexOf("")&&d.opts.unshift(""));d.opts&&a.addDrawMenu("Draw",d.opts,function(a){return e.display(f,a)});if(q&&d.opts&&!q.localfile){var g=c(q.fileurl);0==g.indexOf(JSROOT.source_dir)&&(g=g.slice(JSROOT.source_dir.length));g=q.kind+"="+g;if(0<q.itemname.length){var p=q.itemname;0<=p.search(/\+| |,/)&&(p="'"+p+"'");g+="&item="+p}a.addDrawMenu("Draw in new tab",d.opts,function(a){window.open(JSROOT.source_dir+
"index.htm?nobrowser&"+g+"&opt="+a)})}!d.expand||"_childs"in k||!k._more&&"_more"in k||a.add("Expand",function(){return e.expandItem(f)});"ROOT.TStyle"===k._kind&&a.add("Apply",function(){return e.applyStyle(f)})}else{var l=[],m="",r=0;d=function(){return 0<r++?"&":"?"};e.forEachRootFile(function(a){return l.push(a._file.fFullURL)});e.getTopOnlineItem()||(m=JSROOT.source_dir+"index.htm");e.isMonitoring()&&(m+=d()+"monitoring="+e.getMonitoringInterval());1==l.length?m+=d()+"file="+l[0]:1<l.length&&
(m+=d()+"files="+JSON.stringify(l));e.disp_kind&&(m+=d()+"layout="+e.disp_kind.replace(/ /g,""));var u=[];e.disp&&e.disp.forEachPainter(function(a){a.getItemName()&&u.push(a.getItemName())});1==u.length?m+=d()+"item="+u[0]:1<u.length&&(m+=d()+"items="+JSON.stringify(u));a.add("Direct link",function(){return window.open(m)});a.add("Only items",function(){return window.open(m+"&nobrowser")})}"function"==typeof k._menu&&k._menu(a,k,e);0<a.size()&&(a.tree_node=b.parentNode,a.separ&&a.add("separator"),
a.add("Close"),a.show())});return!1}};l.prototype.createDisplay=function(){if("disp"in this){if(0<this.disp.numDraw())return Promise.resolve(this.disp);this.disp.cleanup();delete this.disp}if(!document.getElementById(this.disp_frameid))return Promise.resolve(null);"tabs"==this.disp_kind?this.disp=new r(this.disp_frameid):0==this.disp_kind.indexOf("flex")?this.disp=new x(this.disp_frameid):0==this.disp_kind.indexOf("coll")?this.disp=new m(this.disp_frameid):this.disp=new JSROOT.GridDisplay(this.disp_frameid,
this.disp_kind);this.disp&&(this.disp.cleanupFrame=this.cleanupFrame.bind(this));return Promise.resolve(this.disp)};l.prototype.enableDrag=function(a){b(a).draggable({revert:"invalid",appendTo:"body",helper:"clone"})};l.prototype.enableDrop=function(a,c){var d=this;b(a).droppable({hoverClass:"ui-state-active",accept:function(a){a=a.parent().parent().attr("item");return a!=c&&a?(a=d.findItem(a))&&"_kind"in a?0==a._kind.indexOf("ROOT."):!1:!1},drop:function(a,c){(a=c.draggable.parent().parent().attr("item"))&&
d.dropItem(a,b(this).attr("id"))}})};l.prototype.createBrowser=function(a,c){var d=this;if(!this.gui_div||this.exclude_browser||!this.brlayout)return Promise.resolve(!1);var e=g.select("#"+this.gui_div+" .jsroot_browser"),f=b(e.node());if(e.empty())return Promise.resolve(!1);"float"===a&&this.float_browser_disabled&&(a="fix");if(!e.select(".jsroot_browser_area").empty())return c&&this.brlayout.toggleKind(a),Promise.resolve(!0);var k="<p class='jsroot_browser_version'><a href='https://root.cern/js/'>JSROOT</a> version <span style='color:green'><b>"+
JSROOT.version+"</b></span></p>";if(this.is_online)k+='<p> Hierarchy in <a href="h.json">json</a> and <a href="h.xml">xml</a> format</p><div style="display:inline-block;"><label style="margin-right:5px; vertical-align:middle;"><input style="vertical-align:middle;" type="checkbox" name="monitoring" class="gui_monitoring"/>Monitoring</label>';else if(this.no_select)"file"==this.no_select&&(k+='<div style="display:flex;flex-direction:row">');else{var h=g.select("#"+this.gui_div),q=h.attr("files")||"../files/hsimple.root";
h=JSROOT.decodeUrl().get("path")||h.attr("path")||"";q=q.split(";");k+='<input type="text" value="" style="width:95%; margin:5px;border:2px;" class="gui_urlToLoad" title="input file name"/><div style="display:flex;flex-direction:row;padding-top:5px"><select class="gui_selectFileName" style="flex:1;padding:2px;" title="select file name"<option value="" selected="selected"></option>';for(var p in q)k+='<option value = "'+h+q[p]+'">'+q[p]+"</option>";k+='</select><input type="file" class="gui_localFile" accept=".root" style="display:none"/><output id="list" style="display:none"></output><input type="button" value="..." class="gui_fileBtn" style="min-width:3em;padding:3px;margin-left:5px;margin-right:5px;" title="select local file for reading"/><br/></div><p id="gui_fileCORS"><small><a href="https://github.com/root-project/jsroot/blob/master/docs/JSROOT.md#reading-root-files-from-other-servers">Read docu</a> how to open files from other servers.</small></p><div style="display:flex;flex-direction:row"><input style="padding:3px;margin-right:5px;"       class="gui_ReadFileBtn" type="button" title="Read the Selected File" value="Load"/><input style="padding:3px;margin-right:5px;"       class="gui_ResetUIBtn" type="button" title="Close all opened files and clear drawings" value="Reset"/>'}if(this.is_online||
!this.no_select||"file"==this.no_select)k+='<select style="padding:2px;margin-right:5px;" title="layout kind" class="gui_layout"></select></div>';k+='<div id="'+this.gui_div+'_browser_hierarchy" class="jsroot_browser_hierarchy"></div>';this.brlayout.setBrowserContent(k);this.brlayout.setBrowserTitle(this.is_online?"ROOT online server":"Read a ROOT file");var t=null;this.is_online||this.no_select||(this.ReadSelectedFile=function(){var a=e.select(".gui_urlToLoad").property("value").trim();a&&(a.toLowerCase().lastIndexOf(".json")==
a.length-5?this.openJsonFile(a):this.openRootFile(a))},f.find(".gui_selectFileName").val("").change(function(){f.find(".gui_urlToLoad").val(b(this).val())}),f.find(".gui_fileBtn").button().click(function(){return f.find(".gui_localFile").click()}),f.find(".gui_ReadFileBtn").button().click(function(){return d.ReadSelectedFile()}),f.find(".gui_ResetUIBtn").button().click(function(){return d.clearHierarchy(!0)}),f.find(".gui_urlToLoad").keyup(function(a){13==a.keyCode&&d.ReadSelectedFile()}),f.find(".gui_localFile").change(function(a){a=
a.target.files;for(var b=0;b<a.length;++b){var c=a[b];e.select(".gui_urlToLoad").property("value",c.name);d.openRootFile(c).then(t)}t=null}),this.selectLocalFile=function(){var a=this;return new Promise(function(c){t=c;b("#"+a.gui_div+" .jsroot_browser").find(".gui_localFile").click()})});k=f.find(".gui_layout");if(k.length){p="simple;vert2;vert3;vert231;horiz2;horiz32;flex;grid 2x2;grid 1x3;grid 2x3;grid 3x3;grid 4x4;collapsible;tabs".split(";");for(q=0;q<p.length;++q)h=document.createElement("option"),
h.value=p[q],h.innerHTML=p[q],k.get(0).appendChild(h);var l=this;k.change(function(){l.setDisplay(b(this).val()||"collapsible",l.gui_div+"_drawing")})}this.setDom(this.gui_div+"_browser_hierarchy");c&&(this.refreshHtml(),this.initializeBrowser());this.brlayout.toggleBrowserKind(a||"fix");return Promise.resolve(!0)};l.prototype.initializeBrowser=function(){var a=g.select("#"+this.gui_div+" .jsroot_browser");if(!a.empty()&&this.brlayout){var c=b(a.node());this.brlayout&&this.brlayout.adjustBrowserSize();
if(a=a.select(".gui_layout").node()){var d=!1;for(f in a.options){var e=a.options[f].text;if("string"===typeof e&&(e==this.getLayout()||e.replace(/ /g,"")==this.getLayout())){a.selectedIndex=f;d=!0;break}}if(!d){var f=document.createElement("option");f.innerHTML=f.value=this.getLayout();a.appendChild(f);a.selectedIndex=a.options.length-1}}if(this.is_online){this.h&&this.h._toptitle&&this.brlayout.setBrowserTitle(this.h._toptitle);var k=this;c.find(".gui_monitoring").prop("checked",this.isMonitoring()).click(function(){k.enableMonitoring(this.checked);
k.updateItems()})}else if(!this.no_select){var h="";this.forEachRootFile(function(a){h||(h=a._fullurl)});c.find(".gui_urlToLoad").val(h)}}};l.prototype.enableMonitoring=function(a){this.setMonitoring(void 0,a);var b=g.select("#"+this.gui_div+" .jsroot_browser .gui_monitoring");b.empty()||b.property("checked")===a||b.property("checked",a)};JSROOT.buildGUI=function(a,b){var c="string"==typeof a?g.select("#"+a):g.select(a);if(c.empty())return alert("no div for gui found");var e=!1;"online"==b&&(e=!0);
"true"===c.attr("ignoreurl")&&(JSROOT.settings.IgnoreUrlOptions=!0);if(JSROOT.decodeUrl().has("nobrowser")||c.attr("nobrowser")&&"false"!==c.attr("nobrowser")||"draw"==b||"nobrowser"==b)return JSROOT.buildNobrowserGUI(a,b);n.readStyleFromURL();var f=new JSROOT.HierarchyPainter("root",null);f.is_online=e;return f.startGUI(c).then(function(){f.initializeBrowser();return f})};var m=function(a){a=JSROOT.MDIDisplay.call(this,a)||this;a.cnt=0;return a};$jscomp.inherits(m,JSROOT.MDIDisplay);m.prototype.forEachFrame=
function(a,c){var d=this.frameid+"_collapsible";document.getElementById(d)&&"function"==typeof a&&b("#"+d+" .collapsible_draw").each(function(){c&&b(this).is(":hidden")||a(b(this).get(0))})};m.prototype.getActiveFrame=function(){var a=JSROOT.MDIDisplay.prototype.getActiveFrame.call(this);if(a&&!b(a).is(":hidden"))return a;a=null;this.forEachFrame(function(b){a||(a=b)},!0);return a};m.prototype.activateFrame=function(a){b(a).is(":hidden")&&b(a).prev().toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideDown(0);
b(a).prev()[0].scrollIntoView();this.active_frame_title=g.select(a).attr("frame_title")};m.prototype.createFrame=function(a){this.beforeCreateFrame(a);var c=this.frameid+"_collapsible";document.getElementById(c)||b("#"+this.frameid).append('<div id="'+c+'" class="jsroot ui-accordion ui-accordion-icons ui-widget ui-helper-reset" style="overflow:auto; overflow-y:scroll; height:100%; padding-left: 2px; padding-right: 2px"></div>');var d=this,e=c+"_sub"+this.cnt++,f=e+"h",g='<h5 id="'+f+"\"><span class='ui-icon ui-icon-triangle-1-e'></span><a> "+
a+"</a>&nbsp; <button type='button' class='jsroot_collaps_closebtn' style='float:right; width:1.4em' title='close canvas'/> </h5>\n<div class='collapsible_draw' id='"+e+"'></div>\n";b("#"+c).append(g);b("#"+f).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-top ui-corner-bottom").hover(function(){b(this).toggleClass("ui-state-hover")}).click(function(){b(this).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideToggle(0);
var a=b(this).next(),c=a.is(":hidden");a.css("display",c?"none":"");c||JSROOT.resize(a.get(0))}).next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide();b("#"+f).find(" .jsroot_collaps_closebtn").button({icons:{primary:"ui-icon-close"},text:!1}).click(function(){d.cleanupFrame(b(this).parent().next().attr("id"));b(this).parent().next().remove();b(this).parent().remove()});b("#"+f).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideToggle(0);
return b("#"+e).attr("frame_title",a).css("overflow","hidden").attr("can_resize","height").css("position","relative").get(0)};var r=function(a){a=JSROOT.MDIDisplay.call(this,a)||this;a.cnt=0;return a};$jscomp.inherits(r,JSROOT.MDIDisplay);r.prototype.forEachFrame=function(a,c){var d=this.frameid+"_tabs";if(document.getElementById(d)&&"function"==typeof a){var e=-1,f=b("#"+d).tabs("option","active");b("#"+d+"> .tabs_draw").each(function(){e++;c&&e!=f||a(b(this).get(0))})}};r.prototype.getActiveFrame=
function(){var a=null;this.forEachFrame(function(b){a||(a=b)},!0);return a};r.prototype.activateFrame=function(a){var c=0,d=-1;this.forEachFrame(function(e){b(e).attr("id")==b(a).attr("id")&&(d=c);c++});b("#"+this.frameid+"_tabs").tabs("option","active",d);this.active_frame_title=g.select(a).attr("frame_title")};r.prototype.createFrame=function(a){this.beforeCreateFrame(a);var c=this,d=this.frameid+"_tabs",e=d+"_sub"+this.cnt++,f='<li><a href="#'+e+'">'+a+'</a><span class="ui-icon ui-icon-close" style="float: left; margin: 0.4em 0.2em 0 0; cursor: pointer;" role="presentation">Remove Tab</span></li>',
g='<div class="tabs_draw" id="'+e+'"></div>';if(document.getElementById(d))b("#"+d).find("> .ui-tabs-nav").append(f),b("#"+d).append(g),b("#"+d).tabs("refresh"),b("#"+d).tabs("option","active",-1);else{b("#"+this.frameid).append('<div id="'+d+'" class="jsroot"> <ul>'+f+" </ul>"+g+"</div>");var h=b("#"+d).css("overflow","hidden").tabs({heightStyle:"fill",activate:function(a,c){b(c.newPanel).css("overflow","hidden");JSROOT.resize(b(c.newPanel).get(0))}});h.delegate("span.ui-icon-close","click",function(){var a=
b(this).closest("li").remove().attr("aria-controls");c.cleanupFrame(a);b("#"+a).remove();h.tabs("refresh");0==b("#"+d+"> .tabs_draw").length&&b("#"+d).remove()})}b("#"+e).empty().css("overflow","hidden").attr("frame_title",a);return b("#"+e).get(0)};r.prototype.checkMDIResize=function(a,c){b("#"+this.frameid+"_tabs").tabs("refresh");JSROOT.MDIDisplay.prototype.checkMDIResize.call(this,a,c)};var x=function(a){a=JSROOT.MDIDisplay.call(this,a)||this;a.cnt=0;return a};$jscomp.inherits(x,JSROOT.MDIDisplay);
x.prototype.forEachFrame=function(a,c){var d=this.frameid+"_flex";document.getElementById(d)&&"function"==typeof a&&b("#"+d+" .flex_draw").each(function(){c&&b(this).is(":hidden")||a(b(this).get(0))})};x.prototype.getActiveFrame=function(){var a=JSROOT.MDIDisplay.prototype.getActiveFrame.call(this);if(a&&!b(a).is(":hidden"))return a;a=null;this.forEachFrame(function(b){a||(a=b)},!0);return a};x.prototype.createFrame=function(a){function c(a){if("first"===a&&(a=null,b("#"+e+" .flex_frame").each(function(){b(this).is(":hidden")||
"minimal"==b(this).prop("state")||(a=b(this))}),!a))return;a.appendTo(a.parent());"minimal"!=a.prop("state")&&(a=a.find(".flex_draw").get(0),n.selectActivePad({pp:n.getElementCanvPainter(a),active:!0}),JSROOT.resize(a))}function d(a,b){var e=a.prop("state");e||(e="normal");a.prop("state",b);if(b!=e){"normal"==e&&(a.prop("original_height",a.height()),a.prop("original_width",a.width()),a.prop("original_top",a.css("top")),a.prop("original_left",a.css("left")));a.find(".jsroot_minbutton").find(".ui-icon").toggleClass("ui-icon-triangle-1-s",
"minimal"!=b).toggleClass("ui-icon-triangle-2-n-s","minimal"==b);a.find(".jsroot_maxbutton").find(".ui-icon").toggleClass("ui-icon-triangle-1-n","maximal"!=b).toggleClass("ui-icon-triangle-2-n-s","maximal"==b);switch(b){case "minimal":a.height(a.find(".flex_header").height()).width("auto");a.find(".flex_draw").css("display","none");a.find(".ui-resizable-handle").css("display","none");break;case "maximal":a.height("100%").width("100%").css("left","").css("top","");a.find(".flex_draw").css("display",
"");a.find(".ui-resizable-handle").css("display","none");break;default:a.find(".flex_draw").css("display",""),a.find(".ui-resizable-handle").css("display",""),a.height(a.prop("original_height")).width(a.prop("original_width")),"minimal"!=e&&a.css("left",a.prop("original_left")).css("top",a.prop("original_top"))}"minimal"!==b?c(a):c("first")}}this.beforeCreateFrame(a);var e=this.frameid+"_flex";document.getElementById(e)||b("#"+this.frameid).append('<div id="'+e+'" class="jsroot" style="overflow:none; height:100%; width:100%"></div>');
var f=this,g=b("#"+e),h=g.width(),l=g.height(),p=e+"_frame"+this.cnt;g.append('<div id="'+p+'" class="flex_frame" style="position:absolute"><div class="ui-widget-header flex_header"><p>'+a+'</p><button type="button" style="float:right; width:1.4em"/><button type="button" style="float:right; width:1.4em"/><button type="button" style="float:right; width:1.4em"/></div><div id="'+p+'_cont" class="flex_draw"></div></div>');b("#"+p).css("left",parseInt(this.cnt%5*h/10)).css("top",parseInt(this.cnt%5*l/
10)).width(Math.round(.58*h)).height(Math.round(.58*l)).resizable({helper:"jsroot-flex-resizable-helper",start:function(){c(b(this))},stop:function(a,c){a={width:c.size.width-1,height:c.size.height-b(this).find(".flex_header").height()-1};JSROOT.resize(b(this).find(".flex_draw").get(0),a)}}).draggable({containment:"parent",start:function(a,e){c(b(this));var d=b(this).find(".flex_draw");a=document.elementFromPoint(a.clientX,a.clientY);var f=!1;b(a).parents().map(function(){b(this).get(0)===d.get(0)&&
(f=!0)});if(f)return!1}}).click(function(){c(b(this))}).find(".flex_header").click(function(){c(b(this).parent())}).dblclick(function(){var a=b(this).parent();"normal"==a.prop("state")?d(a,"maximal"):d(a,"normal")}).find("button").first().attr("title","close canvas").button({icons:{primary:"ui-icon-close"},text:!1}).click(function(){var a=b(this).parent().parent();f.cleanupFrame(a.find(".flex_draw").get(0));a.remove();c("first")}).next().attr("title","maximize canvas").addClass("jsroot_maxbutton").button({icons:{primary:"ui-icon-triangle-1-n"},
text:!1}).click(function(){var a=b(this).parent().parent(),c=b(this).find(".ui-icon").hasClass("ui-icon-triangle-1-n");d(a,c?"maximal":"normal")}).next().attr("title","minimize canvas").addClass("jsroot_minbutton").button({icons:{primary:"ui-icon-triangle-1-s"},text:!1}).click(function(){var a=b(this).parent().parent(),c=b(this).find(".ui-icon").hasClass("ui-icon-triangle-1-s");d(a,c?"minimal":"normal")});b("#"+p).find(".ui-resizable-handle").css("z-index","");this.cnt++;return b("#"+p+"_cont").attr("frame_title",
a).get(0)};JSROOT.GridDisplay.prototype.createSeparator=function(a,c,d){c=b(c.append("div").node());c.toggleClass("jsroot_separator",!0).toggleClass(a.vertical?"jsroot_hline":"jsroot_vline",!0).prop("handle",a).attr("separator-id",d.id).css("position","absolute").css(a.vertical?"top":"left","calc("+d.position+"% - 2px)").css(a.vertical?"width":"height",(a.size||100)+"%").css(a.vertical?"height":"width","5px").css("cursor",a.vertical?"ns-resize":"ew-resize");c.bind("changePosition",function(a,c){function e(a,
b){var c=d.vertical?"height":"width",e=d.groups[b].size+"%";a.children("[groupid='"+b+"']").css(c,e).children(".jsroot_separator").css(c,e)}var d=b(this).prop("handle");a=parseInt(b(this).attr("separator-id"));var f=d.groups[a].position;"restore"===c?f=d.groups[a].position0:c&&c.offset&&(f=d.vertical?Math.round((c.offset.top+2-b(this).parent().offset().top)/b(this).parent().innerHeight()*100):Math.round((c.offset.left+2-b(this).parent().offset().left)/b(this).parent().innerWidth()*100));var g=d.groups[a].position-
f;.3>Math.abs(g)||5>Math.min(d.groups[a-1].size-g,d.groups[a].size+g)||(d.groups[a-1].size-=g,d.groups[a].size+=g,d.groups[a].position=f,b(this).css(d.vertical?"top":"left","calc("+f+"% - 2px)"),e(b(this).parent(),a-1),e(b(this).parent(),a),"restore"===c&&(b(this).trigger("resizeGroup",a-1),b(this).trigger("resizeGroup",a)))});c.bind("resizeGroup",function(a,c){a=b(this).parent().children("[groupid='"+c+"']");a.hasClass("jsroot_newgrid")||(a=a.find(".jsroot_newgrid"));a.each(function(){JSROOT.resize(b(this).get(0))})});
c.dblclick(function(){b(this).trigger("changePosition","restore")});c.draggable({axis:a.vertical?"y":"x",cursor:a.vertical?"ns-resize":"ew-resize",containment:"parent",helper:function(){return b(this).clone().css("background-color","grey")},start:function(){var a=b(this).prop("handle"),c=parseInt(b(this).attr("separator-id"));a.groups[c].startpos=a.groups[c].position},drag:function(a,c){b(this).trigger("changePosition",c)},stop:function(){var a=b(this).prop("handle"),c=parseInt(b(this).attr("separator-id"));
.5>Math.abs(a.groups[c].startpos-a.groups[c].position)||(b(this).trigger("resizeGroup",c-1),b(this).trigger("resizeGroup",c))}})};JSROOT.createTreePlayer=function(a){a.draw_first=!0;a.ConfigureOnline=function(a,b,e,f,g){this.setItemName(a,"",this);this.url=b;this.root_version=f;this.askey=e;this.dflt_expr=g};a.configureTree=function(a){this.local_tree=a};a.KeyUp=function(a){13==a.keyCode&&this.PerformDraw()};a.ShowExtraButtons=function(a){var c=this,e=b(this.selectDom().node());e.find(".treedraw_buttons").append(" Cut: <input class='treedraw_cut ui-corner-all ui-widget' style='width:8em;margin-left:5px' title='cut expression'></input> Opt: <input class='treedraw_opt ui-corner-all ui-widget' style='width:5em;margin-left:5px' title='histogram draw options'></input> Num: <input class='treedraw_number' style='width:7em;margin-left:5px' title='number of entries to process (default all)'></input> First: <input class='treedraw_first' style='width:7em;margin-left:5px' title='first entry to process (default first)'></input> <button class='treedraw_clear' title='Clear drawing'>Clear</button>");
var f=this.local_tree?this.local_tree.fEntries:0;e.find(".treedraw_cut").val(a&&a.parse_cut?a.parse_cut:"").keyup(this.keyup);e.find(".treedraw_opt").val(a&&a.drawopt?a.drawopt:"").keyup(this.keyup);e.find(".treedraw_number").val(a&&a.numentries?a.numentries:"").spinner({numberFormat:"n",min:0,page:1E3,max:f||0}).keyup(this.keyup);e.find(".treedraw_first").val(a&&a.firstentry?a.firstentry:"").spinner({numberFormat:"n",min:0,page:1E3,max:f||0}).keyup(this.keyup);e.find(".treedraw_clear").button().click(function(){return JSROOT.cleanup(c.drawid)})};
a.Show=function(a){var c=b(this.selectDom().node());this.drawid="jsroot_tree_player_"+JSROOT._.id_counter++ +"_draw";this.keyup=this.KeyUp.bind(this);var e=a&&(a.parse_cut||a.numentries||a.firstentry);c.html("<div class='treedraw_buttons' style='padding-left:0.5em'><button class='treedraw_exe' title='Execute draw expression'>Draw</button> Expr:<input class='treedraw_varexp ui-corner-all ui-widget' style='width:12em;margin-left:5px' title='draw expression'></input> "+(e?"":"<button class='treedraw_more'>More</button>")+
"</div><hr/><div id='"+this.drawid+"' style='width:100%'></div>");this.setTopPainter();var f=this;this.local_tree&&c.find(".treedraw_buttons").attr("title","Tree draw player for: "+this.local_tree.fName);c.find(".treedraw_exe").button().click(function(){return f.PerformDraw()});c.find(".treedraw_varexp").val(a&&a.parse_expr?a.parse_expr:this.dflt_expr||"px:py").keyup(this.keyup);e?this.ShowExtraButtons(a):c.find(".treedraw_more").button().click(function(){b(this).remove();f.ShowExtraButtons()});this.checkResize()};
a.PerformLocalDraw=function(){var a=this;if(this.local_tree){var d=b(this.selectDom().node()),e={expr:d.find(".treedraw_varexp").val()};0==d.find(".treedraw_more").length&&(e.cut=d.find(".treedraw_cut").val(),e.cut||delete e.cut,e.drawopt=d.find(".treedraw_opt").val(),"dump"===e.drawopt&&(e.dump=!0,e.drawopt=""),e.drawopt||delete e.drawopt,e.numentries=parseInt(d.find(".treedraw_number").val()),isNaN(e.numentries)&&delete e.numentries,e.firstentry=parseInt(d.find(".treedraw_first").val()),isNaN(e.firstentry)&&
delete e.firstentry);e.drawopt&&JSROOT.cleanup(this.drawid);d=function(b){return JSROOT.redraw(a.drawid,b)};e.progress=d;this.local_tree.Draw(e).then(d)}};a.PerformDraw=function(){var a=this;if(this.local_tree)return this.PerformLocalDraw();var d=b(this.selectDom().node()),e=this.url+"/exe.json.gz?compact=3&method=Draw",f=d.find(".treedraw_varexp").val(),g="h_tree_draw",h="",l=f.indexOf(">>");0>l?f+=">>"+g:(g=f.substr(l+2),"+"==g[0]&&(g=g.substr(1)),l=g.indexOf("("),0<l&&(g=g.substr(0,l)));if(0==
d.find(".treedraw_more").length){l=d.find(".treedraw_cut").val();var m=d.find(".treedraw_number").val(),n=d.find(".treedraw_first").val();h=d.find(".treedraw_opt").val();e+='&prototype="const char*,const char*,Option_t*,Long64_t,Long64_t"&varexp="'+f+'"&selection="'+l+'"';""==m&&(m=394499<=this.root_version?"TTree::kMaxEntries":"1000000000");""==n&&(n="0");e+='&option="'+h+'"&nentries='+m+"&firstentry="+n}else e+='&prototype="Option_t*"&opt="'+f+'"';e+="&_ret_object_="+g;d=function(){JSROOT.httpRequest(e,
"object").then(function(b){JSROOT.cleanup(a.drawid);JSROOT.draw(a.drawid,b,h)})};this.askey?(this.askey=!1,JSROOT.httpRequest(this.url+"/root.json","text").then(d)):d()};a.checkResize=function(){var a=b(this.selectDom().node());b("#"+this.drawid).width(a.width());var d=a.height(),e=a.find(".treedraw_buttons").outerHeight(!0);a=a.find("hr").outerHeight(!0);b("#"+this.drawid).height(d-e-a-2);JSROOT.resize(this.drawid)};return a};JSROOT.drawTreePlayer=function(a,b,d,e){var c=a.findItem(b),k=a.getTopOnlineItem(c),
h="",l=0;if(!c||!k)return null;if(e){for(h=c._name;c&&!c._ttree;)c=c._parent;if(!c)return null;b=a.itemFullName(c)}var m=a.getOnlineItemUrl(b);if(!m)return null;k=k._root_version?parseInt(k._root_version):396545;a=a.getDisplay();if(!a)return null;a=a.findFrame(b,!0);if(!a)return null;a=g.select(a).attr("id");a=new JSROOT.BasePainter(a);if(c._childs&&!e)for(e=0;e<c._childs.length;++e){var n=c._childs[e];n&&n._kind&&0==n._kind.indexOf("ROOT.TLeaf")&&2>l&&(0<l++&&(h+=":"),h+=n._name)}JSROOT.createTreePlayer(a);
a.ConfigureOnline(b,m,d,k,h);a.Show();return a};JSROOT.drawTreePlayerKey=function(a,b){return JSROOT.drawTreePlayer(a,b,!0)};JSROOT.drawLeafPlayer=function(a,b){return JSROOT.drawTreePlayer(a,b,!1,!0)};return JSROOT});
