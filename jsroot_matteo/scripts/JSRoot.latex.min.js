var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var l=0;return function(){return l<a.length?{done:!1,value:a[l++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,l,q){a!=Array.prototype&&a!=Object.prototype&&(a[l]=q.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,l){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:l})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(q){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(q||"")+"_"+l++,q)}var l=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,l){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var q=0,t={next:function(){if(q<a.length){var e=q++;return{value:l(e,a[e]),done:!1}}t.next=function(){return{done:!0,value:void 0}};return t.next()}};t[Symbol.iterator]=function(){return t};return t};
$jscomp.polyfill=function(a,l,q,t){if(l){q=$jscomp.global;a=a.split(".");for(t=0;t<a.length-1;t++){var e=a[t];e in q||(q[e]={});q=q[e]}a=a[a.length-1];t=q[a];l=l(t);l!=t&&null!=l&&$jscomp.defineProperty(q,a,{configurable:!0,writable:!0,value:l})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.makeIterator=function(a){var l="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return l?l.call(a):$jscomp.arrayIterator(a)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function l(){this.batch_=null}function q(a){return a instanceof e?a:new e(function(f,e){f(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;l.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var f=this;this.asyncExecuteFunction(function(){f.executeBatch_()})}this.batch_.push(a)};var t=$jscomp.global.setTimeout;l.prototype.asyncExecuteFunction=function(a){t(a,0)};l.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var y=0;y<a.length;++y){var e=a[y];a[y]=null;try{e()}catch(G){this.asyncThrow_(G)}}}this.batch_=null};l.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var f=this.createResolveAndReject_();try{a(f.resolve,f.reject)}catch(E){f.reject(E)}};e.prototype.createResolveAndReject_=function(){function a(a){return function(g){e||(e=!0,a.call(y,g))}}var y=this,e=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var f=null!=a;break a;case "function":f=!0;break a;default:f=!1}f?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var f=void 0;try{f=a.then}catch(E){this.reject_(E);return}"function"==typeof f?
this.settleSameAsThenable_(f,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,e){if(0!=this.state_)throw Error("Cannot settle("+a+", "+e+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=e;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)F.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var F=new l;e.prototype.settleSameAsPromise_=function(a){var e=this.createResolveAndReject_();a.callWhenSettled_(e.resolve,e.reject)};e.prototype.settleSameAsThenable_=function(a,e){var f=this.createResolveAndReject_();try{a.call(e,f.resolve,f.reject)}catch(G){f.reject(G)}};e.prototype.then=function(a,l){function f(a,d){return"function"==typeof a?function(b){try{y(a(b))}catch(A){g(A)}}:d}var y,g,D=new e(function(a,d){y=a;g=d});this.callWhenSettled_(f(a,y),f(l,g));return D};
e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,e){function l(){switch(f.state_){case 1:a(f.result_);break;case 2:e(f.result_);break;default:throw Error("Unexpected state: "+f.state_);}}var f=this;null==this.onSettledCallbacks_?F.asyncExecute(l):this.onSettledCallbacks_.push(l)};e.resolve=q;e.reject=function(a){return new e(function(e,l){l(a)})};e.race=function(a){return new e(function(e,l){for(var f=$jscomp.makeIterator(a),g=f.next();!g.done;g=f.next())q(g.value).callWhenSettled_(e,
l)})};e.all=function(a){var l=$jscomp.makeIterator(a),f=l.next();return f.done?q([]):new e(function(a,g){function e(b){return function(g){h[b]=g;d--;0==d&&a(h)}}var h=[],d=0;do h.push(void 0),d++,q(f.value).callWhenSettled_(e(h.length-1),g),f=l.next();while(!f.done)})};return e},"es6","es3");
JSROOT.define(["d3","painter"],function(a,l){function q(a,e,h,d){var b=function(b){if(!b||"string"!==typeof b||b.indexOf("ex")!==b.length-2)return null;b=parseFloat(b.substr(0,b.length-2));return isNaN(b)?null:b*d.font.size*.5},g=b(h.attr("width")),n=b(h.attr("height")),f=h.attr("style");f=f&&0==f.indexOf("vertical-align:")&&f.indexOf("ex;")==f.length-3?b(f.substr(16,f.length-17)):null;g=!g||.5>=g?1:Math.round(g);n=!n||.5>=n?1:Math.round(n);h.attr("width",g).attr("height",n).attr("style",null);JSROOT.nodejs||
(e=l.getElementRect(e,"bbox"),g=1.05*e.width,n=1.05*e.height);d.valign=f;d.scale&&a.scaleTextDrawing(Math.max(g/d.width,n/d.height),d.draw_g)}function t(a,e,h,d,b,f){a=parseInt(h.attr("width"));var g=parseInt(h.attr("height"));isNaN(g)||isNaN(a)?(h=l.getElementRect(e,"bbox"),a=h.width||a||100,g=h.height||g||10):0<f&&(a/=f,g/=f,h.attr("width",Math.round(a)).attr("height",Math.round(g)));0<f&&d.valign&&(d.valign/=f);null===d.valign&&(d.valign=(b-g)/2);f=b=1;h="x";var A="y";if(180==d.rotate)b=f=-1;else if(270==
d.rotate||90==d.rotate)b=270==d.rotate?-1:1,f=-b,h="y",A="x";"middle"==d.align[0]?d[h]+=b*(d.width-a)/2:"end"==d.align[0]&&(d[h]+=b*(d.width-a));"middle"==d.align[1]?d[A]+=f*(d.height-g)/2:"bottom"==d.align[1]?d[A]+=f*(d.height-g):"bottom-base"==d.align[1]&&(d[A]+=f*(d.height-g-d.valign));a="translate("+d.x+","+d.y+")";d.rotate&&(a+=" rotate("+d.rotate+")");e.attr("transform",a).attr("visibility",null)}var e={"#alpha":"\u03b1","#beta":"\u03b2","#chi":"\u03c7","#delta":"\u03b4","#varepsilon":"\u03b5",
"#phi":"\u03c6","#gamma":"\u03b3","#eta":"\u03b7","#iota":"\u03b9","#varphi":"\u03c6","#kappa":"\u03ba","#lambda":"\u03bb","#mu":"\u03bc","#nu":"\u03bd","#omicron":"\u03bf","#pi":"\u03c0","#theta":"\u03b8","#rho":"\u03c1","#sigma":"\u03c3","#tau":"\u03c4","#upsilon":"\u03c5","#varomega":"\u03d6","#omega":"\u03c9","#xi":"\u03be","#psi":"\u03c8","#zeta":"\u03b6","#Alpha":"\u0391","#Beta":"\u0392","#Chi":"\u03a7","#Delta":"\u0394","#Epsilon":"\u0395","#Phi":"\u03a6","#Gamma":"\u0393","#Eta":"\u0397",
"#Iota":"\u0399","#vartheta":"\u03d1","#Kappa":"\u039a","#Lambda":"\u039b","#Mu":"\u039c","#Nu":"\u039d","#Omicron":"\u039f","#Pi":"\u03a0","#Theta":"\u0398","#Rho":"\u03a1","#Sigma":"\u03a3","#Tau":"\u03a4","#Upsilon":"\u03a5","#varsigma":"\u03c2","#Omega":"\u03a9","#Xi":"\u039e","#Psi":"\u03a8","#Zeta":"\u0396","#varUpsilon":"\u03d2","#epsilon":"\u03b5","#sqrt":"\u221a","#bar":"","#overline":"","#underline":"","#strike":"","#leq":"\u2264","#/":"\u2044","#infty":"\u221e","#voidb":"\u0192","#club":"\u2663",
"#diamond":"\u2666","#heart":"\u2665","#spade":"\u2660","#leftrightarrow":"\u2194","#leftarrow":"\u2190","#uparrow":"\u2191","#rightarrow":"\u2192","#downarrow":"\u2193","#circ":"\u02c6","#pm":"\u00b1","#doublequote":"\u2033","#geq":"\u2265","#times":"\u00d7","#propto":"\u221d","#partial":"\u2202","#bullet":"\u2022","#divide":"\u00f7","#neq":"\u2260","#equiv":"\u2261","#approx":"\u2248","#3dots":"\u2026","#cbar":"|","#topbar":"\u00af","#downleftarrow":"\u21b5","#aleph":"\u2135","#Jgothic":"\u2111",
"#Rgothic":"\u211c","#voidn":"\u2118","#otimes":"\u2297","#oplus":"\u2295","#oslash":"\u2205","#cap":"\u2229","#cup":"\u222a","#supseteq":"\u2287","#supset":"\u2283","#notsubset":"\u2284","#subseteq":"\u2286","#subset":"\u2282","#int":"\u222b","#in":"\u2208","#notin":"\u2209","#angle":"\u2220","#nabla":"\u2207","#oright":"\u00ae","#ocopyright":"\u00a9","#trademark":"\u2122","#prod":"\u220f","#surd":"\u221a","#upoint":"\u02d9","#corner":"\u00ac","#wedge":"\u2227","#vee":"\u2228","#Leftrightarrow":"\u21d4",
"#Leftarrow":"\u21d0","#Uparrow":"\u21d1","#Rightarrow":"\u21d2","#Downarrow":"\u21d3","#LT":"<","#void1":"\u00ae","#copyright":"\u00a9","#void3":"\u2122","#sum":"\u2211","#arctop":"\u239b","#lbar":"\u23b8","#arcbottom":"\u239d","#void8":"","#bottombar":"\u230a","#arcbar":"\u23a7","#ltbar":"\u23a8","#AA":"\u212b","#aa":"\u00e5","#void06":"","#GT":">","#forall":"\u2200","#exists":"\u2203","#vec":"","#dot":"\u22c5","#hat":"\u00b7","#ddot":"","#acute":"acute","#grave":"","#check":"\u2713","#tilde":"\u02dc",
"#slash":"\u2044","#hbar":"\u0127","#box":"\u25fd","#Box":"\u2610","#parallel":"\u2225","#perp":"\u22a5","#odot":"\u2299","#left":"","#right":"","{}":""},F,f=function(a){for(;2<a.length&&"{"==a[0]&&"}"==a[a.length-1];)a=a.substr(1,a.length-2);F||(F=new RegExp("("+Object.keys(e).join("|").replace(/\{/g,"{").replace(/\\}/g,"\\}")+")","g"));a=a.replace(F,function(a){return e[a]});return a=a.replace(/\{\}/g,"")},y={producePlainText:function(a,e,h){h.plain=!0;h.simple_latex&&(h.text=f(h.text));e.text(h.text)},
produceLatex:function(g,e,h,d,b){function A(a,b){if("string"==typeof b){a.rect||(a.rect={x:a.x,y:a.y,height:0,width:0});var c=-a.x;a.x+=b.length*h.font.aver_width*a.fsize;var d=a.x;var g=-(a.y-1.1*a.fsize);var e=a.y+.1*a.fsize}else a.rect||(a.rect=JSROOT.extend({},b)),c=-b.x,d=b.x+b.width,g=-b.y,e=b.y+b.height;b=a.rect;c+=b.x;d-=b.x+b.width;g+=b.y;e-=b.y+b.height;0<c&&(b.x-=c,b.width+=c);0<d&&(b.width+=d);0<g&&(b.y-=g,b.height+=g);0<e&&(b.height+=e);if(a.parent)return A(a.parent,b);h.text_rect=b;
a=b.height;c=b.y+b.height/2;0<a&&(h.mid_shift=-c/a||.001,h.top_shift=-b.y/a||.001)}function n(b){if(.01>Math.abs(b))return null;if(b==Math.round(b))return Math.round(b)+"em";b=b.toFixed(2);0==b.indexOf("0.")?b=b.substr(1):0==b.indexOf("-0.")&&(b="-."+b.substr(3));"0"==b[b.length-1]&&(b=b.substr(0,b.length-1));return b+"em"}function q(b,c){if(JSROOT.nodejs||!b||b.empty())return c||{height:0,width:0};var d=[];for(c=b.node();c&&c!=h.mainnode.node();)d.push(c),c=c.parentNode;b.selectAll("tspan").each(function(){d.push(this)});
b=h.mainnode.selectAll("tspan");3<b.size()&&(h.large_latex=!0);b.each(function(){0>d.indexOf(this)&&a.select(this).attr("display","none")});c=l.getElementRect(h.mainnode,"bbox");b.each(function(){0>d.indexOf(this)&&a.select(this).attr("display",null)});return c}b||(b={lvl:0,x:0,y:0,dx:0,dy:-.1,fsize:h.font_size,parent:null},d=h.text,h.mainnode=e);for(var t=[{name:"#it{"},{name:"#bf{"},{name:"#underline{",deco:"underline"},{name:"#overline{",deco:"overline"},{name:"#strike{",deco:"line-through"},{name:"kern[",
arg:"float"},{name:"lower[",arg:"float"},{name:"scale[",arg:"float"},{name:"#color[",arg:"int"},{name:"#font[",arg:"int"},{name:"_{"},{name:"^{"},{name:"#bar{",deco:"overline"},{name:"#hat{",accent:"\u02c6"},{name:"#check{",accent:"\u02c7"},{name:"#acute{",accent:"\u02ca"},{name:"#grave{",accent:"\u02cb"},{name:"#dot{",accent:"\u02d9"},{name:"#ddot{",accent:"\u02ba"},{name:"#tilde{",accent:"\u02dc"},{name:"#slash{",accent:"\u2215"},{name:"#vec{",accent:"\u02ed"},{name:"#frac{"},{name:"#splitline{"},
{name:"#sqrt[",arg:"int"},{name:"#sqrt{"},{name:"#sum",special:"\u2211",w:.8,h:.9},{name:"#int",special:"\u222b",w:.3,h:1},{name:"#left[",right:"#right]",braces:"[]"},{name:"#left(",right:"#right)",braces:"()"},{name:"#left{",right:"#right}",braces:"{}"},{name:"#left|",right:"#right|",braces:"||"},{name:"#[]{",braces:"[]"},{name:"#(){",braces:"()"},{name:"#{}{",braces:"{}"},{name:"#||{",braces:"||"}],D=!1,k,m,x,r,v,p,c=null,C=null;d;){k=d.length;x=m=null;for(v=0;v<t.length;++v)r=d.indexOf(t[v].name),
0<=r&&r<k&&(k=r,m=t[v]);if(!m&&!D){t=f(d);if(!b.lvl&&t==d){y.producePlainText(g,e,h);break}A(b,t);b.accent&&1==t.length?(g=e.append("svg:tspan").text(t),g=q(g,{width:1E4}),g=Math.min(g.width/b.fsize,.5),e.append("svg:tspan").attr("dx",n(b.dx-g)).attr("dy",n(b.dy-.2)).text(b.accent),b.dy=.2,b.dx=Math.max(.2,g-.2),b.accent=!1):e.text(t);break}0<k&&(D=f(d.substr(0,k)),0<D.length&&(A(b,D),e.append("svg:tspan").attr("dx",n(b.dx)).attr("dy",n(b.dy)).text(D),b.dx=b.dy=0),c=null,delete b.special,delete b.next_super_dy);
if(!m)break;d=d.substr(k+m.name.length);k=p=e.append("svg:tspan");C=c;c={lvl:b.lvl+1,x:b.x,y:b.y,fsize:b.fsize,dx:0,dy:0,parent:b};D=!0;if(m.arg){r=d.indexOf("]{");if(0>r)return console.log("missing argument for ",m.name),!1;x=d.substr(0,r);if("int"==m.arg){if(x=parseInt(x),isNaN(x))return console.log("wrong int argument",d.substr(0,r)),!1}else if("float"==m.arg&&(x=parseFloat(x),isNaN(x)))return console.log("wrong float argument",d.substr(0,r)),!1;d=d.substr(r+2)}r=b.dy;var w=b.dx,B=null;v=1;var u=
"{",z="}";b.dy=b.dx=0;if(m.special)p.attr("dx",n(w)).attr("dy",n(r)).text(m.special),w=r=0,b.special=m,k=q(p),k.width&&k.height&&(m.w=k.width/b.fsize,m.h=k.height/b.fsize-.1);else{if(m.braces)c.left_cont=p.append("svg:tspan"),c.left=c.left_cont.append("svg:tspan").text(m.braces[0]),k=p.append("svg:tspan"),c.left_rect={y:b.y-1.1*b.fsize,height:1.2*b.fsize,x:b.x,width:.6*b.fsize},A(b,c.left_rect),c.braces=m,m.right&&(u=m.name,z=m.right);else if(m.deco)c.deco=m.deco;else if(m.accent)c.accent=m.accent;
else switch(m.name){case "#color[":g.getColor(x)&&p.attr("fill",g.getColor(x));break;case "#kern[":w+=x;break;case "#lower[":b.dy-=x;r+=x;break;case "scale[":v=x;break;case "#font[":(new JSROOT.FontHandler(x)).setFont(p,"without-size");break;case "#it{":b.italic=!0;for(B=b;B=B.parent;)if(void 0!==B.italic){b.italic=!B.italic;break}p.attr("font-style",b.italic?"italic":"normal");break;case "#bf{":b.bold=!0;for(B=b;B=B.parent;)if(void 0!==B.bold){b.bold=!B.bold;break}p.attr("font-weight",b.bold?"bold":
"normal");break;case "#underline{":p.attr("text-decoration","underline");break;case "#overline{":p.attr("text-decoration","overline");break;case "_{":v=.6;c.script="sub";b.special?(b.dx=b.special.w,b.dy=-.7,w-=b.dx,r-=b.dy):(w+=.1*v,r+=.4*v,c.y+=.4*c.fsize,b.dy=-.4*v,C&&"super"===C.script&&(m=q(C.node,C.rect),c.width_limit=m.width,w-=(m.width/c.fsize+.1)*v));break;case "^{":v=.6;c.script="super";b.special?(b.dx=b.special.w,b.dy=b.special.h,w-=b.dx,r-=b.dy):(b.dy=.6*v,b.next_super_dy&&(b.dy-=b.next_super_dy),
w+=.1*v,r-=b.dy,c.y-=.4*c.fsize,C&&"sub"===C.script&&(m=q(C.node,C.rect),c.width_limit=m.width,w-=(m.width/c.fsize+.1)*v));break;case "#frac{":case "#splitline{":c.first=p;c.two_lines=!0;c.need_middle="#frac{"==m.name;c.x0=c.x;r-=.6;b.dy=-.6;break;case "#sqrt{":x=2;case "#sqrt[":c.square_root=p.append("svg:tspan"),c.square_root.append("svg:tspan").text(3==x?"\u221b":4==x?"\u221c":"\u221a"),k=p.append("svg:tspan"),c.sqrt_rect={y:b.y-1.1*b.fsize,height:1.2*b.fsize,x:0,width:.7*b.fsize},A(b,c.sqrt_rect)}1!==
v&&(p.attr("font-size",Math.round(100*v)+"%"),c.fsize*=v,w/=v,r/=v);b.special&&!c.script&&delete b.special;delete b.next_super_dy;for(c.node=p;;){c.x+=w*c.fsize;c.y+=r*c.fsize;p.attr("dx",n(w)).attr("dy",n(r));w=r=0;r=-1;for(v=1;0!=v&&++r<d.length;)d.indexOf(u,r)===r?v++:d.indexOf(z,r)===r&&v--;if(0!=v)return console.log("mismatch with open "+u+" and close "+z+" braces in Latex",d),!1;m=d.substr(0,r);if(!y.produceLatex(g,k,h,m,c))return!1;b.x=c.x;b.y=c.y;b.dx+=c.dx*c.fsize/b.fsize;b.dy+=c.dy*c.fsize/
b.fsize;d=d.substr(r+z.length);c.width_limit&&(m=q(k,c.rect),m.width<c.width_limit&&(b.dx+=(c.width_limit-m.width)/b.fsize),delete c.width_limit);b.special&&(m=q(k,c.rect),b.dx-=m.width/b.fsize);if(c.square_root){u=2;w=0;u=1;z=q(c.square_root,c.sqrt_rect);k=q(k,c.rect);k.height>z.height&&0<z.height&&(u=k.height/z.height*1.2,w=(k.y+k.height-(z.y+z.height))/b.fsize/u,c.square_root.style("font-size",Math.round(100*u)+"%").attr("dy",n(w)));u=k.width/c.fsize/u;k="";for(u=Math.round(Math.max(3*u,2));u--;)k+=
"\u203e";c.square_root.append("svg:tspan").attr("dy",n(-.25)).text(k);c.square_root.append("svg:tspan").attr("dy",n(.25-w)).attr("dx",n(-k.length/3-.2)).text("\u2009");break}if(c.deco){if(0==k.selectAll("tspan").size()){k.attr("text-decoration",c.deco);break}w=q(k,c.rect).width/c.fsize;z=u=p=void 0;switch(c.deco){case "underline":u=.35;p=1.2;z="\uff3f";break;case "overline":u=-.35;p=3;z="\u203e";break;default:u=0,p=1.8,z="\u23af"}p=Math.round(Math.max(w*p,1));for(m="";p--;)m+=z;k.append("svg:tspan").attr("dx",
n(-w-.2)).attr("dy",n(u)).text(m);b.dy-=u;break}if(c.braces){u=q(c.left_cont,c.left_rect);z=q(k,c.rect);k=1;w=0;1.2*u.height<z.height&&(k=z.height/u.height,w=0,c.left.style("font-size",Math.round(100*k)+"%").attr("dy",n(w)),c.left_cont.append("svg:tspan").attr("dx",n(-.2)).attr("dy",n(-w*k)).text("\u2009"),b.next_super_dy=-.3*k);c.left_rect.y=b.y;c.left_rect.height*=k;A(b,c.left_rect);u=p.append("svg:tspan").attr("dx",n(b.dx)).attr("dy",n(b.dy));b.dx=b.dy=0;1!=k&&u.append("svg:tspan").attr("dx",n(-.2)).text("\u2009");
u=u.append("svg:tspan").text(c.braces.braces[1]);1!=k&&(u.style("font-size",Math.round(100*k)+"%").attr("dy",n(w)),b.dy=-w*k);break}if(c.first&&c.second){k=q(c.first,c.rect1);p=q(c.second,c.rect);k=k.width/c.fsize;p=p.width/c.fsize;m=Math.max(p,k);if(c.need_middle){m=Math.round(Math.max(m,1)+.3);for(x="";x.length<m;)x+="\u2014";e.append("svg:tspan").attr("dx",n(-.5*(m+p))).attr("dy",n(b.dy-.2)).text(x);b.dy=.2;b.dx=.2}else b.dx=.2,p<k&&(b.dx+=.5*(k-p));c.need_middle||"middle"==h.align[0]?(c.first.attr("dx",
n(.5*(m-k))),c.second.attr("dx",n(-.5*(p+k)))):"end"==h.align[0]?(k<p&&c.first.attr("dx",n(p-k)),c.second.attr("dx",n(-p))):c.second.attr("dx",n(-k));delete c.first;delete c.second}if(!c.two_lines)break;if("{"!=d[0])return console.log("missing { for second line",d),!1;d=d.substr(1);p=k=e.append("svg:tspan");c.two_lines=!1;c.rect1=c.rect;delete c.rect;c.x=c.x0;c.second=p;r=b.dy+1.6;b.dy=-.4;c.dx=c.dy=0}}}return!0},LoadMathjax:function(){var a=void 0!==JSROOT._.mj_loading;if(!a&&"undefined"!=typeof MathJax)return Promise.resolve(MathJax);
a||(JSROOT._.mj_loading=[]);var e=new Promise(function(a){JSROOT._.mj_loading?JSROOT._.mj_loading.push(a):a(MathJax)});if(a)return e;var f={scale:1,minScale:.5,mtextInheritFont:!1,merrorInheritFont:!0,mathmlSpacing:!1,skipAttributes:{},exFactor:.5,displayAlign:"center",displayIndent:"0",fontCache:"local",localID:null,internalSpeechTitles:!0,titleID:0};JSROOT.nodejs||(window.MathJax={options:{enableMenu:!1},loader:{load:["[tex]/color"]},tex:{packages:{"[+]":["color"]}},svg:f,startup:{ready:function(){MathJax.startup.defaultReady();
var a=JSROOT._.mj_loading;delete JSROOT._.mj_loading;a.forEach(function(b){return b(MathJax)})}}});JSROOT.require("mathjax").then(function(a){JSROOT.nodejs&&a.init({loader:{load:["input/tex","output/svg","[tex]/color"]},tex:{packages:{"[+]":["color"]}},svg:f,config:{JSDOM:require("jsdom").JSDOM},startup:{typeset:!1,ready:function(){MathJax.startup.registerConstructor("jsdomAdaptor",function(){return new MathJax._.adaptors.HTMLAdaptor.HTMLAdaptor((new MathJax.config.config.JSDOM).window)});MathJax.startup.useAdaptor("jsdomAdaptor",
!0);MathJax.startup.defaultReady();var b=JSROOT._.mj_loading;delete JSROOT._.mj_loading;b.forEach(function(b){return b(MathJax)})}}})});return e}},E={"#LT":"\\langle","#GT":"\\rangle","#club":"\\clubsuit","#spade":"\\spadesuit","#heart":"\\heartsuit","#diamond":"\\diamondsuit","#voidn":"\\wp","#voidb":"f","#copyright":"(c)","#ocopyright":"(c)","#trademark":"TM","#void3":"TM","#oright":"R","#void1":"R","#3dots":"\\ldots","#lbar":"\\mid","#void8":"\\mid","#divide":"\\div","#Jgothic":"\\Im","#Rgothic":"\\Re",
"#doublequote":'"',"#plus":"+","#minus":"-","#/":"/","#upoint":".","#aa":"\\mathring{a}","#AA":"\\mathring{A}","#omicron":"o","#Alpha":"A","#Beta":"B","#Epsilon":"E","#Zeta":"Z","#Eta":"H","#Iota":"I","#Kappa":"K","#Mu":"M","#Nu":"N","#Omicron":"O","#Rho":"P","#Tau":"T","#Chi":"X","#varomega":"\\varpi","#corner":"?","#ltbar":"?","#bottombar":"?","#notsubset":"?","#arcbottom":"?","#cbar":"?","#arctop":"?","#topbar":"?","#arcbar":"?","#downleftarrow":"?","#splitline":"\\genfrac{}{}{0pt}{}","#it":"\\textit",
"#bf":"\\textbf","#frac":"\\frac","#left{":"\\lbrace","#right}":"\\rbrace","#left\\[":"\\lbrack","#right\\]":"\\rbrack","#\\[\\]{":"\\lbrack"," } ":"\\rbrack","#\\[":"\\lbrack","#\\]":"\\rbrack","#{":"\\lbrace","#}":"\\rbrace"," ":"\\;"},G=function(a,f,h,d){if(2!=f){for(var b in E)a=a.replace(new RegExp(b,"g"),E[b]);for(var g in e)2<g.length&&(a=a.replace(new RegExp(g,"g"),"\\"+g.substr(1)));f="";for(b=!0;a;){g=a.indexOf("#color[");if(0>g&&b){f=a;break}b=!1;if(0!=g){var n=0>g?a:a.substr(0,g);f+=n;
if(0>g)break}a=a.substr(g+7);g=a.indexOf("]{");if(0>=g)break;n=parseInt(a.substr(0,g));if(isNaN(n))break;n=d.getColor(n);var l=1;a=a.substr(g+2);for(g=-1;l&&++g<a.length;)"{"==a[g]?l++:"}"==a[g]&&l--;if(0!=l)break;l=a.substr(0,g);a=a.substr(g+1);l&&(f+="\\color{"+n+"}{"+l+"}")}a=f}else a=a.replace(/\\\^/g,"\\hat");return"string"!=typeof h?a:"\\color{"+h+"}{"+a+"}"};y.produceMathjax=function(e,f,h){var d=G(h.text,h.latex,h.color,e),b={em:h.font.size,ex:h.font.size/2,family:h.font.name,scale:1,containerWidth:-1,
lineWidth:1E5};return y.LoadMathjax().then(function(){return MathJax.tex2svgPromise(d,b)}).then(function(b){var d=a.select(b).select("svg");f.append(function(){return d.node()});q(e,f,d,h);h.applyAttributesToMathJax=t;return!0})};y.typesetMathjax=function(a){return y.LoadMathjax().then(function(){return MathJax.typesetPromise(a?[a]:void 0)})};JSROOT.nodejs&&(module.exports=y);return y});
